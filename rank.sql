-- drop table if exists foo;
-- create table if not exists foo (
--     name    text,
--     age     int,
--     depname text
-- );
-- INSERT INTO "foo" (name,age,depname) VALUES ('Griffith',23,'Quality Assurance'),('Brynn',23,'Advertising'),('Wesley',23,'Asset Management'),('Uta',27,'Sales and Marketing'),('Burke',33,'Finances'),('Vladimir',28,'Finances'),('Courtney',32,'Advertising'),('Sopoline',20,'Asset Management'),('Gisela',38,'Legal Department'),('Rosalyn',40,'Media Relations'),('Lillian',21,'Finances'),('Joy',23,'Finances'),('Lewis',32,'Accounting'),('Wesley',35,'Sales and Marketing'),('Vance',39,'Advertising'),('Raymond',35,'Public Relations'),('Jamalia',30,'Customer Service'),('Ursula',25,'Asset Management'),('Vladimir',25,'Advertising'),('Talon',34,'Public Relations'),('Veda',38,'Payroll'),('Hermione',37,'Legal Department'),('Maggie',20,'Legal Department'),('Ezra',20,'Legal Department'),('Chandler',33,'Advertising'),('Ina',40,'Asset Management'),('Maggy',26,'Public Relations'),('Buffy',28,'Human Resources'),('Jayme',28,'Finances'),('Dane',38,'Asset Management'),('Miriam',36,'Finances'),('Venus',38,'Accounting'),('Thane',20,'Advertising'),('Rafael',37,'Media Relations'),('Hamilton',33,'Media Relations'),('Zoe',32,'Human Resources'),('Sarah',25,'Customer Service'),('Halla',29,'Payroll'),('Kalia',40,'Human Resources'),('Armando',22,'Quality Assurance'),('Echo',28,'Customer Service'),('Myra',38,'Customer Service'),('Chancellor',20,'Human Resources'),('Hillary',31,'Sales and Marketing'),('Griffin',32,'Research and Development'),('Scarlet',22,'Payroll'),('Daria',29,'Payroll'),('Amy',33,'Payroll'),('Adrian',39,'Media Relations'),('Genevieve',36,'Public Relations'),('Drake',28,'Legal Department'),('Piper',22,'Finances'),('Hilel',38,'Customer Service'),('Joshua',25,'Legal Department'),('Vielka',30,'Advertising'),('Mannix',31,'Media Relations'),('Ivy',40,'Accounting'),('Callie',40,'Accounting'),('Kieran',22,'Quality Assurance'),('Philip',26,'Advertising'),('Raja',40,'Tech Support'),('Karyn',34,'Quality Assurance'),('Amaya',21,'Legal Department'),('Moana',38,'Media Relations'),('Conan',32,'Tech Support'),('Phyllis',30,'Research and Development'),('Damon',36,'Payroll'),('Lara',26,'Accounting'),('Caesar',36,'Finances'),('Heather',33,'Asset Management'),('Deacon',33,'Tech Support'),('Isaac',26,'Accounting'),('Stephen',38,'Legal Department'),('Basia',23,'Legal Department'),('Tanner',21,'Advertising'),('Lucius',30,'Advertising'),('Medge',28,'Customer Relations'),('Jason',34,'Human Resources'),('Pearl',22,'Asset Management'),('Valentine',27,'Asset Management'),('Jackson',39,'Sales and Marketing'),('Kato',21,'Customer Relations'),('Haley',39,'Quality Assurance'),('Xaviera',35,'Research and Development'),('Guy',25,'Human Resources'),('Nevada',28,'Tech Support'),('Bell',22,'Asset Management'),('Stephanie',36,'Asset Management'),('Chester',21,'Public Relations'),('Marvin',28,'Media Relations'),('Sylvester',30,'Asset Management'),('Hayes',25,'Customer Relations'),('Sage',33,'Legal Department'),('Ishmael',27,'Payroll'),('Trevor',29,'Finances'),('Marny',22,'Customer Service'),('Nasim',29,'Public Relations'),('Quon',27,'Asset Management'),('Ainsley',25,'Accounting'),('Raja',34,'Asset Management');
select name, age, depname,
       row_number() over (partition by depname order by age),
       rank() over (partition by depname order by age),
       dense_rank() over (partition by depname order by age)
  from foo;